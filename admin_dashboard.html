{% extends "layout.html" %}

{% block title %}
Admin Dashboard
{% endblock %}

{% block content %}
<div class="container mt-5">

  <!-- Search bar -->
  <div class="row justify-content-center mb-5">
    <div class="col-md-6">
      <form method="GET" action="{{ url_for('admin_dashboard') }}">
        <div class="input-group">
          <input type="text" class="form-control" name="search_query" placeholder="Search patients or doctors..." aria-label="Search" value="{{ search_query or '' }}">
          <button class="btn btn-primary" type="submit">Search</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Conditional search results -->
  {% if search_query %}
  <h4 class="mb-4">Search results for "{{ search_query }}":</h4>

  <h5>Patients</h5>
  <ul>
    {% for patient in patients %}
    <li>{{ patient.name }} ({{ patient.username }})</li>
    {% else %}
    <li>No patients found.</li>
    {% endfor %}
  </ul>

  <h5 class="mt-4">Doctors</h5>
  <ul>
    {% for doctor in doctors %}
    <li>{{ doctor.name or doctor.username }} ({{ doctor.department }})</li>
    {% else %}
    <li>No doctors found.</li>
    {% endfor %}
  </ul>

  {% else %}
  <!-- Stats cards -->
  <div class="row text-center g-4">
    
    <div class="col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Patients</h5>
          <p class="card-text display-4">{{ patient_count }}</p>
          <a href="{{ url_for('viewpatient') }}" class="btn btn-outline-primary">View Patients</a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Doctors</h5>
          <p class="card-text display-4">{{ doctor_count }}</p>
          <a href="{{ url_for('viewdoc') }}" class="btn btn-outline-primary">View Doctors</a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Appointments</h5>
          <p class="card-text display-4">{{ appointment_count }}</p>
          <a href="{{ url_for('viewappointment') }}" class="btn btn-outline-primary">View Appointments</a>
        </div>
      </div>
    </div>

  </div>
  {% endif %}

</div>
{% endblock %}
